var app=angular.module("myApp",["ionic","ionic-toast"]);app.config(["$ionicConfigProvider","$httpProvider","$stateProvider","$urlRouterProvider",function(e,t,o,s){e.tabs.position("bottom");var a=["$q","$window","$location","$injector",function(e,t,o,s){return{request:function(t){return t.headers.hasOwnProperty("addToken")&&(delete t.headers.addToken,localStorage.getItem("token")&&(t.headers.Authorization="Bearer "+localStorage.getItem("token"))),t||e.when(t)},response:function(t){return t||e.when(t)},requestError:function(t){return e.reject(t)},responseError:function(t){return e.reject(t)}}}];t.interceptors.push(a),s.otherwise("/tabs/test"),o.state("tabs",{url:"/tabs",views:{main:{"abstract":!0,templateUrl:"dist/html/tabs.html",controller:"tabsCtrl"}}}).state("tabs.test",{url:"/test",views:{"test-tab":{templateUrl:"dist/html/tab_test.html",controller:"tabTestCtrl"}}}).state("tabs.examinationsBank",{url:"/examinationsBank",views:{"test-tab":{templateUrl:"dist/html/tab_test_examinationsBank.html",controller:"tabTestExaminationsBankCtrl"}}}).state("tabs.startAnswer",{url:"/startAnswer",views:{"test-tab":{templateUrl:"dist/html/tab_test_startAnswer.html",controller:"tabTestStartAnswerCtrl"}}}).state("tabs.social",{url:"/social",views:{"social-tab":{templateUrl:"dist/html/tab_social.html",controller:"tabSocialCtrl"}}}).state("tabs.socialDetail",{url:"/socialDetail",params:{item:null},views:{"social-tab":{templateUrl:"dist/html/tab_socialDetail.html",controller:"tabSocialDetailCtrl"}}}).state("tabs.music",{url:"/music",views:{"music-tab":{templateUrl:"dist/html/tab_music.html",controller:"tabMusicCtrl"}}}).state("tabs.musicPlayer",{url:"/musicPlayer",params:{musicType:null},views:{"music-tab":{templateUrl:"dist/html/tab_musicPlayer.html",controller:"tabMusicPlayerCtrl"}}}).state("tabs.reading",{url:"/reading",views:{"reading-tab":{templateUrl:"dist/html/tab_reading.html",controller:"tabReadingCtrl"}}}).state("tabs.readingList",{url:"/readingList/",params:{readType:""},views:{"reading-tab":{templateUrl:"dist/html/tab_readingList.html",controller:"tabReadingListCtrl"}}}).state("tabs.readingDetail",{url:"/readingDetail",params:{read:null,fromPage:"",readType:""},views:{"reading-tab":{templateUrl:"dist/html/tab_readingDetail.html",controller:"tabReadingDetailCtrl"}}}).state("tabs.user",{url:"/user",views:{"user-tab":{templateUrl:"dist/html/tab_user.html",controller:"tabUserCtrl"}}}).state("tabs.userMessages",{url:"/userMessages",views:{"user-tab":{templateUrl:"dist/html/tab_user_messages.html",controller:"tabUserMessagesCtrl"}}}).state("tabs.systemMessages",{url:"/systemMessages",views:{"user-tab":{templateUrl:"dist/html/tab_user_messages_sysList.html",controller:"tabUserMessagesSysListCtrl"}}}).state("tabs.commentMessages",{url:"/commentMessages",views:{"user-tab":{templateUrl:"dist/html/tab_user_messages_comtList.html",controller:"tabUserMessagesComtListCtrl"}}}).state("tabs.userInformationSettings",{url:"/userInformationSettings",views:{"user-tab":{templateUrl:"dist/html/tab_user_information_settings.html",controller:"tabUserInformationSettingsCtrl"}}}).state("tabs.userInformationSettingsSetHeadPicture",{url:"/setHeadPicture",views:{"user-tab":{templateUrl:"dist/html/tab_user_information_settings_set_head_picture.html",controller:"setHeadPictureCtrl"}}}).state("tabs.userTestHistoryRecords",{url:"/userTestHistoryRecords",views:{"user-tab":{templateUrl:"dist/html/tab_user_testHistoryRecords.html",controller:"tabUserTestHistoryRecordsCtrl"}}}).state("tabs.userDataAnalysis",{url:"/userDataAnalysis",views:{"user-tab":{templateUrl:"dist/html/tab_user_dataAnalysis.html",controller:"tabUserDataAnalysisCtrl"}}}).state("tabs.userFavorite",{url:"/userFavorite",views:{"user-tab":{templateUrl:"dist/html/tab_user_favorite.html",controller:"tabUserFavoriteCtrl"}}}).state("tabs.appAbout",{url:"/appAbout",views:{"user-tab":{templateUrl:"dist/html/tab_user_appAbout.html"}}}).state("tabs.facts",{url:"/facts",views:{"home-tab":{templateUrl:"dist/html/facts.html"}}}).state("tabs.facts2",{url:"/facts2",views:{"home-tab":{prefetchTemplate:!1,templateUrl:"dist/html/facts2.html"}}})}]),app.service("ajax_service",function(){var e="http://localhost:8080",t=e+"/CMHSP",o=t+"/";this.absoluteurl=function(){return o};var s=t+"/examinationsList";this.get_examinationsList=function(){return s};var a=t+"/examinationsResults";this.return_examinationsResults=function(){return a};var n=t+"/socialFreshDown";this.get_socialFreshDown=function(){return n};var r=t+"/socialFreshUp";this.get_socialFreshUp=function(){return r};var i=t+"/showComments";this.get_socialComments=function(){return i};var c=t+"/socialAdd";this.add_social=function(){return c};var l=t+"/socialCommentAdd";this.add_socialComment=function(){return l};var u=t+"/socialFavorite";this.add_socialFavorite=function(){return u};var m=t+"/musicSceneList";this.get_musicSceneList=function(){return m};var d=t+"/musicFavorite";this.add_musicFavorite=function(){return d};var _=t+"/readFirstPage";this.get_readFirstPage=function(){return _};var g=t+"/readSearch";this.read_search=function(){return g};var f=t+"/readDetil";this.get_readDetil=function(){return f};var p=t+"/readList";this.get_readList=function(){return p};var h=t+"/readFavour";this.add_readFavorite=function(){return h};var y=e+"/user/register";this.register=function(){return y};var v=e+"/user/login";this.login=function(){return v};var w=t+"/userNotice";this.get_userNotice=function(){return w};var I=t+"/userGetsysMessage";this.get_userSysMessage=function(){return I};var b=t+"/userGetComments";this.get_userComments=function(){return b};var S=t+"/userClearNews";this.clear_userNews=function(){return S};var x=t+"/userUpdate";this.update_userMessages=function(){return x};var T=e+"/user/logout";this.logout=function(){return T};var $=t+"/userHisRecords";this.get_userTestRecords=function(){return $};var N=t+"/userAnalysis";this.get_userAnalysis=function(){return N};var C=t+"/userFavorite";this.get_userFavorite=function(){return C}}),app.run(["$rootScope","$timeout","$ionicModal","$http","$state","$ionicViewSwitcher","ajax_service","loading_service","ionicToast",function(e,t,o,s,a,n,r,i,c){e.examinations_list=[],e.examination_default={},e.login_account={userName:"",userPassword:""},e.register_account={userName:"",userPassword:"",userPassword_again:""},e.judge_login=function(){return localStorage.hasOwnProperty("token")},e.judge_firstLoading=function(){localStorage.hasOwnProperty("firstLoading")||setTimeout(function(){e.openHelloSlidesModal()},700)},e.fn_show_toast=function(e,t){0==e?c.show(!1,t,"bottom",!1,2e3):1==e?c.show(!0,t,"top",!1,2e3):2==e?c.show(!0,t,"bottom",!1,2e3):c.show(!1,t,"top",!1,2e3)},e.fn_login=function(t,o,a){i.show_loading(),s({method:"post",url:r.login(),data:JSON.stringify({username:t,password:o,logintime:a}),headers:{"Content-Type":"application/json"}}).success(function(t){0==t.error_code&&(localStorage.setItem("token",t.data.token),localStorage.setItem("userId",t.data.userId),localStorage.setItem("userName",t.data.userName),localStorage.setItem("userImage",t.data.userImage),localStorage.setItem("userRegion",t.data.userRegion),localStorage.setItem("userSign",t.data.userSign),e.closeLoginModal())}).error(function(){setTimeout(function(){e.fn_show_toast(0,"用户名或密码错误")},500)})},e.fn_register=function(t,o){i.show_loading(),s({method:"post",url:r.register(),data:JSON.stringify({username:t,password:o}),headers:{"Content-Type":"application/json"}}).success(function(s){0==s.error_code&&(setTimeout(function(){e.login_account.userName=t,e.login_account.userPassword=o},300),setTimeout(function(){e.login()},1e3),e.closeRegisterModal())}).error(function(){setTimeout(function(){e.fn_show_toast(0,"注册失败")},500)})},o.fromTemplateUrl("html/user_login_modal.html",{scope:e,animation:"slide-in-up"}).then(function(t){e.login_modal=t}),e.login=function(){return""==e.login_account.userName?void e.fn_show_toast(0,"用户名不能为空"):""==e.login_account.userPassword?void e.fn_show_toast(0,"密码不能为空"):null==e.login_account.userName.match(/^[a-zA-Z0-9]+$/)||null==e.login_account.userPassword.match(/^[a-zA-Z0-9]+$/)?void e.fn_show_toast(0,"用户名或密码格式错误"):void e.fn_login(e.login_account.userName,e.login_account.userPassword,i.get_time())},e.openLoginModal=function(){e.login_modal.show()},e.closeLoginModal=function(){e.login_modal.hide(),setTimeout(function(){e.login_account.userName="",e.login_account.userPassword=""},100)},o.fromTemplateUrl("html/user_register_modal.html",{scope:e,animation:"slide-in-up"}).then(function(t){e.register_modal=t}),e.register=function(){return""==e.register_account.userName?void e.fn_show_toast(0,"用户名不能为空"):""==e.register_account.userPassword?void e.fn_show_toast(0,"密码不能为空"):""==e.register_account.userPassword_again?void e.fn_show_toast(0,"确认密码不能为空"):e.register_account.userPassword!=e.register_account.userPassword_again?void e.fn_show_toast(0,"两次输入密码不一致"):null==e.register_account.userName.match(/^[a-zA-Z0-9]+$/)||null==e.register_account.userPassword.match(/^[a-zA-Z0-9]+$/)||null==e.register_account.userPassword_again.match(/^[a-zA-Z0-9]+$/)?void e.fn_show_toast(0,"用户名或密码格式错误"):void e.fn_register(e.register_account.userName,e.register_account.userPassword)},e.openRegisterModal=function(){e.register_modal.show()},e.closeRegisterModal=function(){e.register_modal.hide(),setTimeout(function(){e.register_account.userName="",e.register_account.userPassword="",e.register_account.userPassword_again=""},100)},o.fromTemplateUrl("html/hello_slides_modal.html",{scope:e,animation:"slide-in-left"}).then(function(t){e.helloSlides_modal=t}),e.openHelloSlidesModal=function(){e.helloSlides_modal.show()},e.closeHelloSlidesModal=function(){e.helloSlides_modal.hide(),localStorage.setItem("firstLoading","true")}}]),app.service("loading_service",["$ionicLoading","$timeout",function(e,t){this.show_loading=function(){e.show({content:"Loading",animation:"fade-in",showBackdrop:!0,maxWidth:200,showDelay:0}),t(function(){e.hide()},800)},this.get_time=function(){var e=new Date,t=e.getFullYear(),o=e.getMonth()+1,s=e.getDate(),a=(e.getDay(),e.getHours()),n=e.getMinutes(),r=t+"-";return o<10&&(r+="0"),r+=o+"-",s<10&&(r+="0"),r+=s+" ",a<10&&(r+="0"),r+=a+":",n<10&&(r+="0"),r+=n,console.log(r),r}}]),app.service("particle_service",[function(){this.CanvasParticle=function(){function e(e){e=e||{};var s=document.getElementById("mydiv"),a=document.createElement("canvas"),n={element:a,points:[],config:{vx:e.vx||4,vy:e.vy||4,height:e.height||2,width:e.width||2,count:e.count||100,color:e.color||"121, 162, 185",stroke:e.stroke||"130,255,255",dist:e.dist||6e3,e_dist:e.e_dist||2e4,max_conn:10}};return n.element.getContext("2d")?(n.context=n.element.getContext("2d"),s.style.padding="0",s.style.margin="0",s.appendChild(n.element),n.element.style="position: fixed; top: 0; left: 0; z-index: -1;",t(n.element),window.onresize=function(){t(n.element)},s.onmousemove=function(e){var t=e||window.event;n.mouse={x:t.clientX,y:t.clientY}},document.onmouseleave=function(){n.mouse=void 0},void setInterval(function(){o(n)},40)):null}function t(e){var t=document.getElementById("mydiv").style.width,o=document.getElementById("mydiv").style.height;t=parseInt(t),o=parseInt(o),e.width=t||window.innerWeight||document.documentElement.clientWidth||document.body.clientWidth,e.height=o||window.innerWeight||document.documentElement.clientHeight||document.body.clientHeight}function o(e){var t,o=e.context;o.clearRect(0,0,e.element.width,e.element.height),o.beginPath(),o.fillStyle="rgb("+e.config.color+")";for(var n=0,r=e.config.count;n<r;n++)t=e.points.length!=e.config.count?{x:Math.floor(Math.random()*e.element.width),y:Math.floor(Math.random()*e.element.height),vx:e.config.vx/2-Math.random()*e.config.vx,vy:e.config.vy/2-Math.random()*e.config.vy}:s(e.points[n],e),o.fillRect(t.x-e.config.width/2,t.y-e.config.height/2,e.config.width,e.config.height),e.points[n]=t;a(o,e,e.mouse),o.closePath()}function s(e,t){var o=e;return e.x<=0||e.x>=t.element.width?(o.vx=-o.vx,o.x+=o.vx):e.y<=0||e.y>=t.element.height?(o.vy=-o.vy,o.y+=o.vy):o={x:o.x+o.vx,y:o.y+o.vy,vx:o.vx,vy:o.vy},o}function a(e,t,o){e=e||t.context;for(var s=0,a=t.config.count;s<a;s++){t.points[s].max_conn=0;for(var n=0;n<a;n++)s!=n&&(dist=Math.round(t.points[s].x-t.points[n].x)*Math.round(t.points[s].x-t.points[n].x)+Math.round(t.points[s].y-t.points[n].y)*Math.round(t.points[s].y-t.points[n].y),dist<=t.config.dist&&t.points[s].max_conn<t.config.max_conn&&(t.points[s].max_conn++,e.lineWidth=.5-dist/t.config.dist,e.strokeStyle="rgba("+t.config.stroke+","+(1-dist/t.config.dist)+")",e.beginPath(),e.moveTo(t.points[s].x,t.points[s].y),e.lineTo(t.points[n].x,t.points[n].y),e.stroke()));o&&(dist=Math.round(t.points[s].x-o.x)*Math.round(t.points[s].x-o.x)+Math.round(t.points[s].y-o.y)*Math.round(t.points[s].y-o.y),dist>t.config.dist&&dist<=t.config.e_dist&&(t.points[s].x=t.points[s].x+(o.x-t.points[s].x)/20,t.points[s].y=t.points[s].y+(o.y-t.points[s].y)/20),dist<=t.config.e_dist&&(e.lineWidth=1,e.strokeStyle="rgba("+t.config.stroke+","+(1-dist/t.config.e_dist)+")",e.beginPath(),e.moveTo(t.points[s].x,t.points[s].y),e.lineTo(o.x,o.y),e.stroke()))}}return e}()}]),angular.module("ionic-toast",["ionic-toast.provider"]),angular.module("ionic-toast.provider",[]).provider("ionicToast",function(){var e={position:"top",showClose:!1,theme:"dark",timeOut:4e3};this.configure=function(t){angular.extend(e,t)},this.$get=["$compile","$document","$interval","$rootScope","$templateCache","$timeout",function(t,o,s,a,n,r){var i={},c=a.$new(),l=e.timeOut,u={toastClass:"",toastMessage:"",toastStyle:{display:"none",opacity:0}},m={top:"ionic_toast_top",middle:"ionic_toast_middle",bottom:"ionic_toast_bottom"},d=t(n.get("ionic-toast/templates/ionic-toast.html"))(c);c.ionicToast=u,o.find("body").append(d);var _=function(e,t,o){c.ionicToast.toastStyle={display:e,opacity:t},c.ionicToast.toastStyle.opacity=t,o()};return c.hideToast=function(){_("none",0,function(){})},i.show=function(t,o,s,a,n){o&&(s=s||e.position,n=n||e.timeOut,n>1e4&&(n=1e4),angular.extend(c.ionicToast,{toastClass:m[s]+" "+(a?"ionic_toast_sticky":"")+" "+(t?"toast_background_correct":"toast_background_error"),toastMessage:o}),_("block",1,function(){a||(l=r(function(){c.hideToast()},n))}))},i.hide=function(){c.hideToast()},i}]}),angular.module("ionic-toast").run(["$templateCache",function(e){var t='<div class="ionic_toast"><div class="toast_section" ng-class="ionicToast.toastClass" ng-style="ionicToast.toastStyle" ng-click="hideToast()"><span class="ionic_toast_close"><i class="ion-android-close toast_close_icon"></i></span><span ng-bind-html="ionicToast.toastMessage"></span></div></div>';e.put("ionic-toast/templates/ionic-toast.html",t)}]),app.controller("tabUserTestHistoryRecordsCtrl",["$scope","$rootScope","$ionicLoading","$ionicPopup","ajax_service","$http","$timeout","loading_service",function(e,t,o,s,a,n,r,i){i.show_loading(),e.arr_test_historyRecords=[];e.$on("$ionicView.beforeEnter",function(){e.fn_get_historyRecords()}),e.fn_get_historyRecords=function(){if(t.judge_login()){var o=window.localStorage.getItem("userId");n({method:"post",url:a.get_userTestRecords(),data:JSON.stringify({userId:o}),headers:{"Content-Type":"application/json",addToken:!0}}).success(function(t){0==t.error_code&&(e.arr_test_historyRecords=t.data)}).error(function(e){})}},e.showAlert=function(e){s.alert({title:e.testName,subTitle:e.testScore+"分  "+e.summary,template:"测试结论: "+e.conclusion,buttons:[{text:"知道了",type:"button-balanced"}]})}}]),app.controller("tabUserDataAnalysisCtrl",["$scope","$rootScope","$ionicLoading","$ionicPopup","ajax_service","$http","$timeout","loading_service",function(e,t,o,s,a,n,r,i){i.show_loading(),e.show_dataAnalysis=!1,e.user_information={userImage:"imgs/default_userImage.png",userName:"",userId:""},e.arr_userAnalysis={},localStorage.hasOwnProperty("userId")?(e.show_dataAnalysis=!0,e.user_information.userId=localStorage.getItem("userId"),localStorage.hasOwnProperty("userName")&&(e.user_information.userName=localStorage.getItem("userName")),localStorage.hasOwnProperty("userImage")&&(e.user_information.userImage=localStorage.getItem("userImage"))):e.show_dataAnalysis=!0;e.fn_get_userAnalysis=function(){if(t.judge_login()){var o=window.localStorage.getItem("userId");n({method:"post",url:a.get_userAnalysis(),data:JSON.stringify({userId:o}),headers:{"Content-Type":"application/json",addToken:!0}}).success(function(t){0==t.error_code&&(e.arr_userAnalysis=t.data)}).error(function(e){})}},e.fn_get_userAnalysis();var c=echarts.init(document.getElementById("echarts_test1")),l=echarts.init(document.getElementById("echarts_test2")),u=echarts.init(document.getElementById("echarts_test3")),m={title:{left:"center",text:"数据加载中..."},tooltip:{},legend:{data:[""]},xAxis:{data:[]},yAxis:{},series:[{name:"分数",type:"bar",data:[]}]};c.setOption(m),l.setOption(m),u.setOption(m),r(function(){console.log(2222),option1={title:{left:"center",text:e.arr_userAnalysis.testScore[0].examName},tooltip:{},legend:{data:[""]},xAxis:{data:e.arr_userAnalysis.testScore[0].testTime},yAxis:{},series:[{name:"分数",type:"bar",data:e.arr_userAnalysis.testScore[0].score}]},c.setOption(option1);var t={title:{left:"center",text:e.arr_userAnalysis.testScore[1].examName},tooltip:{},legend:{data:[""]},xAxis:{data:e.arr_userAnalysis.testScore[1].testTime},yAxis:{},series:[{name:"分数",type:"line",data:e.arr_userAnalysis.testScore[1].score}]};l.setOption(t);var o={title:{left:"center",text:e.arr_userAnalysis.testScore[2].examName},tooltip:{},legend:{data:[""]},xAxis:{data:e.arr_userAnalysis.testScore[2].testTime},yAxis:{},series:[{name:"分数",type:"bar",data:e.arr_userAnalysis.testScore[2].score}]};u.setOption(o);var s=[[55,9,56,.46,18,6,1],[25,11,21,.65,34,9,2],[56,7,63,.3,14,5,3],[33,7,29,.33,16,6,4],[42,24,44,.76,40,16,5],[82,58,90,1.77,68,33,6],[74,49,77,1.46,48,27,7],[78,55,80,1.29,59,29,8],[267,216,280,4.8,108,64,9],[185,127,216,2.52,61,27,10],[39,19,38,.57,31,15,11],[41,11,40,.43,21,7,12],[64,38,74,1.04,46,22,13],[108,79,120,1.7,75,41,14],[108,63,116,1.48,44,26,15],[33,6,29,.34,13,5,16],[94,66,110,1.54,62,31,17],[186,142,192,3.88,93,79,18],[57,31,54,.96,32,14,19],[22,8,17,.48,23,10,20],[39,15,36,.61,29,13,21],[94,69,114,2.08,73,39,22],[99,73,110,2.43,76,48,23],[31,12,30,.5,32,16,24],[42,27,43,1,53,22,25],[154,117,157,3.05,92,58,26],[234,185,230,4.09,123,69,27],[160,120,186,2.77,91,50,28],[134,96,165,2.76,83,41,29],[52,24,60,1.03,50,21,30],[46,5,49,.28,10,6,31]],a=[[26,37,27,1.163,27,13,1],[85,62,71,1.195,60,8,2],[78,38,74,1.363,37,7,3],[21,21,36,.634,40,9,4],[41,42,46,.915,81,13,5],[56,52,69,1.067,92,16,6],[64,30,28,.924,51,2,7],[55,48,74,1.236,75,26,8],[76,85,113,1.237,114,27,9],[91,81,104,1.041,56,40,10],[84,39,60,.964,25,11,11],[64,51,101,.862,58,23,12],[70,69,120,1.198,65,36,13],[77,105,178,2.549,64,16,14],[109,68,87,.996,74,29,15],[73,68,97,.905,51,34,16],[54,27,47,.592,53,12,17],[51,61,97,.811,65,19,18],[91,71,121,1.374,43,18,19],[73,102,182,2.787,44,19,20],[73,50,76,.717,31,20,21],[84,94,140,2.238,68,18,22],[93,77,104,1.165,53,7,23],[99,130,227,3.97,55,15,24],[146,84,139,1.094,40,17,25],[113,108,137,1.481,48,15,26],[81,48,62,1.619,26,3,27],[56,48,68,1.336,37,9,28],[82,92,174,3.29,0,13,29],[106,116,188,3.628,101,16,30],[118,50,0,1.383,76,11,31]],n=[[91,45,125,.82,34,23,1],[65,27,78,.86,45,29,2],[83,60,84,1.09,73,27,3],[109,81,121,1.28,68,51,4],[106,77,114,1.07,55,51,5],[109,81,121,1.28,68,51,6],[106,77,114,1.07,55,51,7],[89,65,78,.86,51,26,8],[53,33,47,.64,50,17,9],[80,55,80,1.01,75,24,10],[117,81,124,1.03,45,24,11],[99,71,142,1.1,62,42,12],[95,69,130,1.28,74,50,13],[116,87,131,1.47,84,40,14],[108,80,121,1.3,85,37,15],[134,83,167,1.16,57,43,16],[79,43,107,1.05,59,37,17],[71,46,89,.86,64,25,18],[97,71,113,1.17,88,31,19],[84,57,91,.85,55,31,20],[87,63,101,.9,56,41,21],[104,77,119,1.09,73,48,22],[87,62,100,1,72,28,23],[168,128,172,1.49,97,56,24],[65,45,51,.74,39,17,25],[39,24,38,.61,47,17,26],[39,24,39,.59,50,19,27],[93,68,96,1.05,79,29,28],[188,143,197,1.66,99,51,29],[174,131,174,1.55,108,50,30],[187,143,201,1.39,89,53,31]],r={normal:{width:1,opacity:.5}},i=echarts.init(document.getElementById("echarts_test4")),m={backgroundColor:"#161627",title:{text:"",left:"center",textStyle:{color:"#eee"}},legend:{bottom:5,data:["北京","上海","广州"],itemGap:20,textStyle:{color:"#fff",fontSize:14},selectedMode:"single"},radar:{indicator:[{name:"AQI",max:300},{name:"PM2.5",max:250},{name:"PM10",max:300},{name:"CO",max:5},{name:"NO2",max:200},{name:"SO2",max:100}],shape:"circle",splitNumber:5,name:{textStyle:{color:"rgb(238, 197, 102)"}},splitLine:{lineStyle:{color:["rgba(238, 197, 102, 0.1)","rgba(238, 197, 102, 0.2)","rgba(238, 197, 102, 0.4)","rgba(238, 197, 102, 0.6)","rgba(238, 197, 102, 0.8)","rgba(238, 197, 102, 1)"].reverse()}},splitArea:{show:!1},axisLine:{lineStyle:{color:"rgba(238, 197, 102, 0.5)"}}},series:[{name:"北京",type:"radar",lineStyle:r,data:s,symbol:"none",itemStyle:{normal:{color:"#F9713C"}},areaStyle:{normal:{opacity:.1}}},{name:"上海",type:"radar",lineStyle:r,data:n,symbol:"none",itemStyle:{normal:{color:"#B3E4A1"}},areaStyle:{normal:{opacity:.05}}},{name:"广州",type:"radar",lineStyle:r,data:a,symbol:"none",itemStyle:{normal:{color:"rgb(238, 197, 102)"}},areaStyle:{normal:{opacity:.05}}}]};i.setOption(m);for(var d=[],_=+new Date,g=[],f=[],p=0;p<20;p++){var h=new Date(_+=864e5);d.push([h.getFullYear(),h.getMonth()+1,h.getDate()].join("-"));var y=200*Math.random(),v=200*Math.random();f.push(y),g.push(v+y)}var w=echarts.init(document.getElementById("echarts_test5")),I={backgroundColor:"#0f375f",tooltip:{trigger:"axis",axisPointer:{type:"shadow"}},legend:{data:["line","bar"],textStyle:{color:"#ccc"}},xAxis:{data:d,axisLine:{lineStyle:{color:"#ccc"}}},yAxis:{splitLine:{show:!1},axisLine:{lineStyle:{color:"#ccc"}}},series:[{name:"line",type:"line",smooth:!0,showAllSymbol:!0,symbol:"emptyCircle",symbolSize:15,data:g},{name:"bar",type:"bar",barWidth:10,itemStyle:{normal:{barBorderRadius:5,color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"#14c8d4"},{offset:1,color:"#43eec6"}])}},data:f},{name:"line",type:"bar",barGap:"-100%",barWidth:10,itemStyle:{normal:{color:new echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:"rgba(20,200,212,0.5)"},{offset:.2,color:"rgba(20,200,212,0.2)"},{offset:1,color:"rgba(20,200,212,0)"}])}},z:-12,data:g},{name:"dotted",type:"pictorialBar",symbol:"rect",itemStyle:{normal:{color:"#0f375f"}},symbolRepeat:!0,symbolSize:[12,4],symbolMargin:1,z:-10,data:g}]};w.setOption(I);var b=echarts.init(document.getElementById("echarts_test6")),S={series:[{type:"liquidFill",data:[.6,{value:.5,direction:"left"},.4,{value:.3,direction:"left"}],radius:"70%",outline:{show:!1}}]};b.setOption(S)},500)}]),app.controller("tabUserFavoriteCtrl",["$scope","$rootScope","$ionicLoading","$ionicPopup","ajax_service","$http","$timeout","loading_service",function(e,t,o,s,a,n,r,i){i.show_loading(),e.arr_userFavorites=[];e.fn_get_userFavorites=function(){if(t.judge_login()){var o=window.localStorage.getItem("userId");n({method:"post",url:a.get_userFavorite(),data:JSON.stringify({userId:o}),headers:{"Content-Type":"application/json",addToken:!0}}).success(function(t){0==t.error_code&&(e.arr_userFavorites=t.data)}).error(function(e){})}},e.fn_get_userFavorites()}]),app.controller("tabsCtrl",["$scope",function(e){}]),app.controller("tabTestCtrl",["$scope","$rootScope","$state","$ionicViewSwitcher","$http","ajax_service","particle_service",function(e,t,o,s,a,n,r){e.$on("$ionicView.loaded",function(){t.judge_firstLoading(),e.fn_show_particle(),e.fn_get_examinations_list()}),e.fn_show_particle=function(){var e={vx:5,vy:5,height:1,width:1,count:80,color:"255, 255, 255",stroke:"130,255,255",dist:5500,e_dist:0,max_conn:5};r.CanvasParticle(e)},e.fn_get_examinations_list=function(){a({method:"GET",url:n.get_examinationsList(),headers:{"Content-Type":"application/json"}}).success(function(e){0==e.error_code&&(t.examinations_list=e.data,t.examination_default=t.examinations_list[0],console.log(t.examinations_list),console.log(t.examination_default))}).error(function(e){})},e.fn_start_answer=function(){console.log(t.judge_login()),t.judge_login()?(o.go("tabs.startAnswer"),s.nextDirection("forward")):t.openLoginModal()}}]),app.controller("tabTestStartAnswerCtrl",["$scope","$ionicSlideBoxDelegate","loading_service","ajax_service","$http","$timeout","$rootScope",function(e,t,o,s,a,n,r){e.$on("$ionicView.beforeEnter",function(){t.enableSlide(!1)}),e.nextSlide=function(e){0==e?t.next():(o.show_loading(),setTimeout(function(){t.next()},500))},e.total_score=0,e.fn_calculate_score=function(t){e.total_score=e.total_score+t,console.log(e.total_score)},e.show_view_results=!1;var i=[],c="",l=0;i=r.examination_default.questionsConclusion,c=r.examination_default.examinationName,l=r.examination_default.examinationId,e.last_results={},e.last_conclusionId=0,e.last_summary="",e.fn_view_results=function(t){for(var o=0,s=i.length;o<s;o++)if(t<=i[o].scoreRange)return e.last_results=i[o],e.last_conclusionId=i[o].conclusionId,e.last_summary=i[o].summary,console.log(e.last_results),void console.log(e.last_conclusionId)},e.user_test_results={userId:0,userName:"",examinationId:0,testTime:"",examinationName:"",examinationScore:0,summary:"",examinationConclusionId:0},e.fn_return_user_test_results=function(){e.fn_view_results(e.total_score),""!=e.last_summary&&(e.user_test_results.userId=parseInt(localStorage.getItem("userId")),e.user_test_results.userName=localStorage.getItem("userName"),e.user_test_results.examinationId=l,e.user_test_results.testTime=o.get_time(),e.user_test_results.examinationName=c,e.user_test_results.examinationScore=e.total_score,e.user_test_results.summary=e.last_summary,e.user_test_results.examinationConclusionId=e.last_conclusionId,a({method:"post",url:s.return_examinationsResults(),data:JSON.stringify(e.user_test_results),cache:!0,headers:{"Content-Type":"application/json",addToken:!0}}).success(function(t){0==t.error_code?e.nextSlide(1):r.fn_show_toast("查看测试结果失败")}).error(function(e){r.fn_show_toast("网络错误")}))}}]),app.controller("tabTestExaminationsBankCtrl",["$scope","$rootScope","$state","ajax_service","$http","$timeout","loading_service",function(e,t,o,s,a,n,r){r.show_loading(),e.default_examination=t.examination_default.examinationName,e.examinationChange=function(e){r.show_loading(),t.examination_default=e,setTimeout(function(){o.go("tabs.test")},200),console.log(t.examination_default)}}]),app.controller("tabSocialCtrl",["$scope","$rootScope","$state","$http","ajax_service","$stateParams","$ionicModal","$timeout","loading_service",function(e,t,o,s,a,n,r,i,c){e.items=[],e.currentPage=1,e.$on("$ionicView.loaded",function(){e.doRefreshDown()}),e.noMorePage=!1,e.arr_last_sociaalId=-1,e.doRefreshDown=function(){s({method:"get",url:a.get_socialFreshDown(),headers:{"Content-Type":"application/json"}}).success(function(o){if(0==o.error_code){var s=o.data;if(0==e.items.length){e.noMorePage=!1;for(var a=0;a<s.length;a++)e.items.push(s[a]);e.arr_last_sociaalId=e.items[e.items.length-1].socialId,console.log("111--"+e.arr_last_sociaalId)}else{var n=e.items[0].socialId,r=s[0].socialId;if(n===r)return setTimeout(function(){t.fn_show_toast(1,"暂无最新动态")},500),e.arr_last_sociaalId=e.items[e.items.length-1].socialId,void console.log("222--"+e.arr_last_sociaalId);e.noMorePage=!1,e.items=[];for(var a=0;a<s.length;a++)e.items.push(s[a]);e.arr_last_sociaalId=e.items[e.items.length-1].socialId,console.log("333--"+e.arr_last_sociaalId),setTimeout(function(){t.fn_show_toast(1,"最新动态加载完成")},500)}}else setTimeout(function(){t.fn_show_toast(0,"网络错误")},500)}).error(function(e){setTimeout(function(){t.fn_show_toast(0,"网络错误")},500)})["finally"](function(){e.arr_last_sociaalId=e.items[e.items.length-1].socialId,console.log("444--"+e.arr_last_sociaalId),e.$broadcast("scroll.refreshComplete"),e.$broadcast("scroll.infiniteScrollComplete")})},e.doFreshUp=function(){e.arr_last_sociaalId<0||s({method:"post",url:a.get_socialFreshUp(),data:JSON.stringify({socialId:e.arr_last_sociaalId}),headers:{"Content-Type":"application/json"}}).success(function(o){if(0==o.error_code){var s=o.data;s.length<5&&(e.noMorePage=!0);for(var a=0;a<s.length;a++)e.items.push(s[a]);console.log(e.arr_last_sociaalId)}else e.noMorePage=!0,setTimeout(function(){t.fn_show_toast(0,"网络错误")},500)}).error(function(){e.noMorePage=!0,setTimeout(function(){t.fn_show_toast(0,"网络错误")},500)})["finally"](function(){e.arr_last_sociaalId=e.items[e.items.length-1].socialId,console.log("555--"+e.arr_last_sociaalId),e.$broadcast("scroll.refreshComplete"),e.$broadcast("scroll.infiniteScrollComplete")})},e.fn_socialDetail=function(e){o.go("tabs.socialDetail",{item:angular.toJson(e)})},e.new_social={imageData:"",textData:""},r.fromTemplateUrl("html/tab_social_add_modal.html",{scope:e,animation:"slide-in-up"}).then(function(t){e.social_add_modal=t}),e.fn_social_add=function(){if(t.judge_login()){c.show_loading();var o={userId:0,userName:"",imageData:"",textData:"",socialAddTime:""};o.userId=localStorage.getItem("userId"),o.userName=localStorage.getItem("userName"),o.imageData="https://img.zcool.cn/community/018cdc5b192e73a8012034f72fd3de.jpeg",o.textData=e.new_social.textData,o.socialAddTime=c.get_time(),s({method:"post",url:a.add_social(),data:JSON.stringify(o),headers:{"Content-Type":"application/json",addToken:!0}}).success(function(s){if(0==s.error_code){var a={userId:"",userName:"",userImg:"",socialAddTime:"",imageData:"https://img.zcool.cn/community/018cdc5b192e73a8012034f72fd3de.jpeg",textData:"",comments:[]};a.userId=o.userId,a.userName=o.userName,a.imageData=o.imageData,a.textData=o.textData,a.socialAddTime=o.socialAddTime,setTimeout(function(){e.items.unshift(a)},500),setTimeout(function(){e.close_social_add_modal()},1e3)}else setTimeout(function(){t.fn_show_toast(0,"网络错误，发布动态失败")},500)}).error(function(e){setTimeout(function(){t.fn_show_toast(0,"网络错误，发布动态失败")},500)})}else t.openLoginModal()},e.open_social_add_modal=function(){t.judge_login()?e.social_add_modal.show():t.openLoginModal()},e.close_social_add_modal=function(){e.new_social.textData="",e.social_add_modal.hide()}}]),app.controller("tabSocialDetailCtrl",["$scope","$rootScope","$state","$stateParams","$http","ajax_service","$ionicLoading","$ionicPopup","$timeout","loading_service",function(e,t,o,s,a,n,r,i,c,l){l.show_loading(),e.ctrlScope=e,e.item={},e.item=angular.fromJson(s.item),e.favorite_ok=!1,e.arr_socialComments=[],e.comment_data="",e.fn_get_socialComments=function(){var o=e.item.socialId;a({method:"post",url:n.get_socialComments(),data:JSON.stringify({socialId:o}),headers:{"Content-Type":"application/json"}}).success(function(o){0==o.error_code?e.arr_socialComments=o.data.reverse():setTimeout(function(){t.fn_show_toast(3,"获取动态评论失败")},500)}).error(function(e){setTimeout(function(){t.fn_show_toast(3,"获取动态评论失败")},500)})},e.fn_get_socialComments(),e.fn_socialFavoriteAdd=function(){if(t.judge_login()){l.show_loading();var o={userId:0,userName:"",socialId:0};o.userId=window.localStorage.getItem("userId"),o.userName=window.localStorage.getItem("userName"),o.socialId=e.item.socialId,a({method:"post",url:n.add_socialFavorite(),data:JSON.stringify(o),headers:{"Content-Type":"application/json",addToken:!0}}).success(function(o){0==o.error_code?(e.favorite_ok=!e.favorite_ok,setTimeout(function(){t.fn_show_toast(1,"收藏动态成功")},500)):1==o.error_code?setTimeout(function(){t.fn_show_toast(1,"动态已收藏")},500):setTimeout(function(){t.fn_show_toast(3,"收藏动态失败")},500)}).error(function(e){setTimeout(function(){t.fn_show_toast(3,"收藏动态失败")},500)})}else t.openLoginModal()},e.fn_socialCommentAdd=function(){if(t.judge_login()){if(""===e.comment_data)return void t.fn_show_toast(4,"评论不可以为空哦");if(e.comment_data.length>20)return t.fn_show_toast(4,"评论最多20个字哦"),void(e.comment_data="");l.show_loading();var o={userId:0,userName:"",userImage:"",socialId:0,commentData:"",commentTime:""},s={cuserName:"",cuserImg:"",commentData:""};o.userId=window.localStorage.getItem("userId"),o.userName=window.localStorage.getItem("userName"),
o.userImage=window.localStorage.getItem("userImage"),o.socialId=e.item.socialId,o.commentData=e.comment_data,o.commentTime=l.get_time(),e.comment_data="",s.cuserName=o.userName,s.cuserImg=o.userImage,s.commentData=o.commentData,a({method:"post",url:n.add_socialComment(),data:JSON.stringify(o),headers:{"Content-Type":"application/json",addToken:!0}}).success(function(o){0==o.error_code?(e.arr_socialComments.unshift(s),setTimeout(function(){t.fn_show_toast(1,"评论成功")},500)):setTimeout(function(){t.fn_show_toast(3,"网络错误，评论失败")},500)}).error(function(e){setTimeout(function(){t.fn_show_toast(3,"网络错误，评论失败")},500)})}else t.openLoginModal()},e.showPopup=function(){e.data={},i.show({template:'<textarea ng-model="data.commentData" placeholder=" 写评论 . . .">',title:"发布评论",scope:e,buttons:[{text:"取消"},{text:"<b>评论</b>",type:"button-stable",onTap:function(t){if(e.data.commentData){var o=e.data.commentData;e.fn_socialCommentAdd(o)}else t.preventDefault()}}]})}}]),app.controller("tabMusicCtrl",["$scope","$rootScope","$state","$ionicViewSwitcher","$http","ajax_service","$stateParams","$timeout","loading_service",function(e,t,o,s,a,n,r,i,c){e.arr_musicType=[{musicsceneId:"1",musicsceneImage:"src/imgs/music_background/music1.jpg",background:"src/imgs/music_background/musicType1.jpg",musicsceneText1:"NEW AGE 电子合成器音乐",musicsceneText2:"烘托氛围 治愈心灵",musicsceneName:"治愈"},{musicsceneId:"2",musicsceneImage:"src/imgs/music_background/music2.jpg",background:"src/imgs/music_background/musicType2.jpg",musicsceneText1:"悦耳节奏带感歌曲精选",musicsceneText2:"日常抖腿必备歌单",musicsceneName:"兴奋"},{musicsceneId:"3",musicsceneImage:"src/imgs/music_background/music3.jpg",background:"src/imgs/music_background/musicType3.jpg",musicsceneText1:"触发心灵的一刹那",musicsceneText2:"总有一首可以触动你的心房",musicsceneName:"感动"},{musicsceneId:"4",musicsceneImage:"src/imgs/music_background/music4.jpg",background:"src/imgs/music_background/musicType4.jpg",musicsceneText1:"享受美妙的音乐",musicsceneText2:"伴随你入睡 调整你的心情",musicsceneName:"安静"},{musicsceneId:"5",musicsceneImage:"src/imgs/music_background/music5.jpg",background:"src/imgs/music_background/musicType5.jpg",musicsceneText1:"有时候快乐很简单",musicsceneText2:"一丝微笑 永远不失孩子气",musicsceneName:"快乐"}],e.fn_toMusicPlayer=function(e){console.log(e),console.log(angular.toJson(e)),o.go("tabs.musicPlayer",{musicType:angular.toJson(e)}),s.nextDirection("forward")}}]),app.controller("tabMusicPlayerCtrl",["$scope","$rootScope","$state","$stateParams","$http","ajax_service","$ionicLoading","$timeout","loading_service",function(e,t,o,s,a,n,r,i,c){e.musicType={},e.musicType=angular.fromJson(s.musicType),c.show_loading(),console.log(s),console.log(e.musicType),e.myAuto=document.getElementById("musicPlayer"),e.music_url="",e.musicList=[],e.music_name="",e.music_auther="",e.fn_get_sceneMusicList=function(){var o=e.musicType.musicsceneId,s=e.musicType.musicsceneName;a({method:"post",url:n.get_musicSceneList(),data:JSON.stringify({musicsceneId:o,musicsceneName:s}),headers:{"Content-Type":"application/json"}}).success(function(o){0==o.error_code?(e.musicList=o.data,$("audio").attr("src",e.musicList[0].songContext),e.music_name=e.musicList[0].songName,e.music_auther=e.musicList[0].songAuthor,console.log(e.music_url)):setTimeout(function(){t.fn_show_toast(0,"网络错误")},500)}).error(function(){setTimeout(function(){t.fn_show_toast(0,"网络错误")},500)})},e.fn_get_sceneMusicList(),e.music_selected={background:"#0000002e !important"},e.music_not_selected={background:"#0000 !important"},e.music_control=!1,e.fn_music_control=function(t){0==t?(e.music_control=!0,e.myAuto.play()):(e.music_control=!1,e.myAuto.pause())},e.fn_music_control(0),e.fn_change_music_url=function(e){$("audio").attr("src",e)},e.music_index=0,e.myAuto.addEventListener("ended",function(){e.fn_change_music(e.music_index,"next"),console.log(e.music_index)},!1),e.fn_change_music=function(t,o){console.log("index: "+t),console.log("direction: "+o),""==o?(e.yes_favorite=!1,e.music_index=t,$("audio").attr("src",e.musicList[t].songContext),e.music_name=e.musicList[t].songName,e.music_auther=e.musicList[t].songAuthor,e.fn_music_control(0),console.log("src: "+e.musicList[t].songContext)):"next"===o?t+1<e.musicList.length?(e.yes_favorite=!1,e.fn_change_music_url(e.musicList[t+1].songContext),e.music_name=e.musicList[t+1].songName,e.music_auther=e.musicList[t+1].songAuthor,e.music_index++,e.fn_music_control(0)):(e.fn_change_music_url(e.musicList[e.musicList.length-1].songContext),e.music_name=e.musicList[e.musicList.length-1].songName,e.music_auther=e.musicList[e.musicList.length-1].songAuthor,e.fn_music_control(0)):"previous"===o&&(t-1>0?(e.yes_favorite=!1,e.fn_change_music_url(e.musicList[t-1].songContext),e.music_name=e.musicList[t-1].songName,e.music_auther=e.musicList[t-1].songAuthor,e.music_index--,e.fn_music_control(0)):(e.fn_change_music_url(e.musicList[0].songContext),e.music_name=e.musicList[0].songName,e.music_auther=e.musicList[0].songAuthor,e.fn_music_control(0)))},e.yes_favorite=!1,e.fn_musicFavorite=function(){if(t.judge_login()){c.show_loading();var o=localStorage.getItem("userId"),s=localStorage.getItem("userName"),r=e.musicList[e.music_index].songId;a({method:"post",url:n.add_musicFavorite(),data:JSON.stringify({userId:o,userName:s,songId:r}),headers:{"Content-Type":"application/json",addToken:!0}}).success(function(o){0==o.error_code?(e.yes_favorite=!0,setTimeout(function(){t.fn_show_toast(1,"收藏成功")},500)):1==o.error_code?(e.yes_favorite=!0,setTimeout(function(){t.fn_show_toast(0,"此歌曲已收藏")},500)):setTimeout(function(){t.fn_show_toast(0,"网络错误")},500)}).error(function(){setTimeout(function(){t.fn_show_toast(0,"网络错误")},500)})}else t.openLoginModal()}}]),app.controller("tabReadingCtrl",["$scope","$state","$ionicSlideBoxDelegate","ajax_service","$http","$timeout","$rootScope",function(e,t,o,s,a,n,r,i){e.$on("$ionicView.enter",function(){o.start()}),e.arr_read_firstPage={},e.fn_read_firstPage=function(){a({method:"get",url:s.get_readFirstPage(),headers:{"Content-Type":"application/json"}}).success(function(t){0==t.error_code?(e.arr_read_firstPage=t.data,o.update(),o.loop(!0)):setTimeout(function(){r.fn_show_toast(0,"网络错误")},500)}).error(function(e){setTimeout(function(){r.fn_show_toast(0,"网络错误")},500)})},e.fn_read_firstPage(),e.fn_readDetail=function(e){console.log(e),console.log(angular.toJson(e)),t.go("tabs.readingDetail",{read:angular.toJson(e),fromPage:"reading"})}}]),app.controller("tabReadingDetailCtrl",["$scope","$rootScope","$ionicLoading","ajax_service","$http","$timeout","$state","$stateParams","loading_service",function(e,t,o,s,a,n,r,i,c){e.read={},e.readContext="",e.read=angular.fromJson(i.read),e.arr_fromPage=i.fromPage,e.arr_readType=i.readType,e.$on("$ionicView.beforeEnter",function(){e.readId=angular.fromJson(i.read).readId,e.fn_get_readList(e.readId)}),e.fn_go_back=function(){"reading"==e.arr_fromPage?r.go("tabs.reading"):"readingList"==e.arr_fromPage&&r.go("tabs.readingList",{readType:e.arr_readType})},e.fn_get_readList=function(o){a({method:"post",url:s.get_readDetil(),data:JSON.stringify({readId:o}),headers:{"Content-Type":"application/json"}}).success(function(o){0==o.error_code?e.readContext=o.data.readContext:setTimeout(function(){t.fn_show_toast(0,"网络错误")},500)}).error(function(e){setTimeout(function(){t.fn_show_toast(0,"网络错误")},500)})},e.fn_readingFavoriteAdd=function(){if(t.judge_login()){c.show_loading();var o={userId:0,readId:0};o.userId=window.localStorage.getItem("userId"),o.readId=e.read.readId,a({method:"post",url:s.add_readFavorite(),data:JSON.stringify(o),headers:{"Content-Type":"application/json",addToken:!0}}).success(function(e){0==e.error_code?setTimeout(function(){t.fn_show_toast(1,"收藏动态成功")},500):1==e.error_code?setTimeout(function(){t.fn_show_toast(1,"动态已收藏")},500):setTimeout(function(){t.fn_show_toast(3,"收藏动态失败")},500)}).error(function(e){setTimeout(function(){t.fn_show_toast(3,"收藏动态失败")},500)})}else t.openLoginModal()}}]),app.controller("tabReadingListCtrl",["$scope","$rootScope","$state","ajax_service","$http","$timeout","$stateParams","loading_service",function(e,t,o,s,a,n,r,i){e.var_search_keyWords="",e.arr_readList=[],e.arr_0=[{readType:1,readId:"6",readTitle:"乌合之众",readAuthor:"古斯塔夫·勒庞",readImage:"imgs/乌合之众.jpg"},{readType:1,readId:"8",readTitle:"性格心理学",readAuthor:"邹宏明",readImage:"imgs/性格心理学.jpg"},{readType:1,readId:"9",readTitle:"社会性动物",readAuthor:"艾略特·阿伦森",readImage:"imgs/社会性动物.jpg"},{readType:1,readId:"10",readTitle:"自控力",readAuthor:"凯利·麦格尼格尔",readImage:"imgs/自控力.jpg"},{readType:1,readId:"11",readTitle:"行为心理学",readAuthor:" 约翰·华生 ",readImage:"imgs/行为心理学.jpg"},{readType:1,readId:"7",readTitle:"心理学与生活",readAuthor:"理查德·格里格 和 菲利普·津巴多",readImage:"imgs/心理学与生活.jpg"}],e.arr_1=[{readType:0,readId:"5",readTitle:"《你不知道的抑郁症》",readAuthor:"杨波",readImage:"imgs/文章3.jpg"},{readType:0,readId:"6",readTitle:"《心理健康的保健方法》",readAuthor:"杨波",readImage:"imgs/文章4.jpg"},{readType:0,readId:"7",readTitle:"《不用怕！这些方法教你避免抑郁症》",readAuthor:"杨波",readImage:"imgs/文章5.jpg"},{readType:0,readId:"3",readTitle:"《心理疾病真的不用怕，我们来帮你!》",readAuthor:"杨波",readImage:"imgs/文章1.jpg"},{readType:0,readId:"4",readTitle:"《心理咨询的正确方式》",readAuthor:"杨波",readImage:"imgs/文章2.jpg"}],e.$on("$ionicView.beforeEnter",function(){e.arr_readType=r.readType,e.fn_get_readList(e.arr_readType)}),e.fn_get_readList=function(o){a({method:"post",url:s.get_readList(),data:JSON.stringify({readType:o}),headers:{"Content-Type":"application/json"}}).success(function(o){0==o.error_code?e.arr_readList=o.data:setTimeout(function(){t.fn_show_toast(0,"网络错误")},500)}).error(function(e){setTimeout(function(){t.fn_show_toast(0,"网络错误")},500)})},e.fn_readSearch=function(o){a({method:"post",url:s.read_search(),data:JSON.stringify({readType:r.readType,searchKeyword:o}),headers:{"Content-Type":"application/json"}}).success(function(o){0==o.error_code?e.arr_readList=o.data:setTimeout(function(){t.fn_show_toast(0,"搜索失败")},500)}).error(function(e){setTimeout(function(){t.fn_show_toast(0,"网络错误")},500)})},e.fn_readDetail=function(e,t){console.log(e),console.log(angular.toJson(e)),o.go("tabs.readingDetail",{read:angular.toJson(e),fromPage:"readingList",readType:t})}}]),app.controller("tabUserCtrl",["$scope","$rootScope","$state","$ionicViewSwitcher","$ionicModal","$http","ajax_service","loading_service",function(e,t,o,s,a,n,r,i){e.default_user_image="imgs/default_userImage.png",e.default_user_name="",e.$watch("judge_login()",function(t,o){1==t?(e.default_user_image=localStorage.getItem("userImage"),e.default_user_name=localStorage.getItem("userName")):e.default_user_image="imgs/default_userImage.png"}),e.$on("$ionicView.beforeEnter",function(){e.fn_get_notices()}),e.show_news=!1,e.fn_get_notices=function(){if(t.judge_login()){var o=localStorage.getItem("userId");n({method:"post",url:r.get_userNotice(),data:JSON.stringify({userId:o}),headers:{"Content-Type":"application/json",addToken:!0}}).success(function(t){0==t.error_code&&(0==t.data.haveNews?e.show_news=!1:e.show_news=!0)}).error(function(){})}},e.fn_user_move_page=function(e){t.judge_login()?0===e?(o.go("tabs.userMessages"),s.nextDirection("forward")):1===e?(o.go("tabs.userInformationSettings"),s.nextDirection("forward")):2===e?(o.go("tabs.userTestHistoryRecords"),s.nextDirection("forward")):3===e?(o.go("tabs.userDataAnalysis"),s.nextDirection("forward")):4===e&&(o.go("tabs.userFavorite"),s.nextDirection("forward")):t.openLoginModal()}}]),app.controller("tabUserMessagesCtrl",["$scope","$rootScope","$timeout","$http","ajax_service",function(e,t,o,s,a){e.sysMessagesNum=0,e.comtMessagesNum=0,e.show_sysMessagesNum=!1,e.show_comtMessagesNum=!1,e.$on("$ionicView.beforeEnter",function(){e.fn_get_notices()}),e.fn_get_notices=function(){if(t.judge_login()){var o=localStorage.getItem("userId");s({method:"post",url:a.get_userNotice(),data:JSON.stringify({userId:o}),headers:{"Content-Type":"application/json",addToken:!0}}).success(function(t){0==t.error_code&&(0==t.data.haveNews?(e.show_sysMessagesNum=!1,e.show_comtMessagesNum=!1):(0==t.data.sysNews?e.show_sysMessagesNum=!1:(e.show_sysMessagesNum=!0,e.sysMessagesNum=t.data.sysNews),0==t.data.comNews?e.show_comtMessagesNum=!1:(e.show_comtMessagesNum=!0,e.comtMessagesNum=t.data.comNews)))}).error(function(){})}}}]),app.controller("tabUserMessagesSysListCtrl",["$scope","$rootScope","$ionicLoading","ajax_service","$http","$timeout","loading_service",function(e,t,o,s,a,n,r){r.show_loading(),e.sys_messages=[],e.fn_get_sysMessage=function(){if(t.judge_login()){var o=window.localStorage.getItem("userId");a({method:"post",url:s.get_userSysMessage(),data:JSON.stringify({userId:o}),headers:{"Content-Type":"application/json",addToken:!0}}).success(function(t){0==t.error_code&&(e.sys_messages=t.data)}).error(function(e){})}},e.fn_get_sysMessage(),e.fn_clear_MessagesNum=function(){if(t.judge_login()){var e=window.localStorage.getItem("userId");a({method:"post",url:s.clear_userNews(),data:JSON.stringify({userId:e,messageType:0}),headers:{"Content-Type":"application/json",addToken:!0}}).success(function(e){0==e.error_code&&console.log("该用户系统消息已读")}).error(function(){})}}}]),app.controller("tabUserMessagesComtListCtrl",["$scope","$rootScope","$ionicLoading","ajax_service","$http","$timeout","loading_service",function(e,t,o,s,a,n,r){r.show_loading(),e.comt_messages=[],e.fn_get_comtMessage=function(){if(t.judge_login()){var o=window.localStorage.getItem("userId");a({method:"post",url:s.get_userComments(),data:JSON.stringify({userId:o}),headers:{"Content-Type":"application/json",addToken:!0}}).success(function(t){0==t.error_code&&(e.comt_messages=t.data)}).error(function(e){})}},e.fn_get_comtMessage(),e.fn_clear_MessagesNum=function(){if(t.judge_login()){var e=window.localStorage.getItem("userId");a({method:"post",url:s.clear_userNews(),data:JSON.stringify({userId:e,messageType:1}),headers:{"Content-Type":"application/json",addToken:!0}}).success(function(e){0==e.error_code&&console.log("该用户评论消息已读")}).error(function(){})}}}]),app.controller("tabUserInformationSettingsCtrl",["$scope","$rootScope","$state","$ionicViewSwitcher","$ionicModal","$http","ajax_service","loading_service",function(e,t,o,s,a,n,r,i){function c(e,t,o){var s=e.substr(0,o),a=e.substr(o,e.length);return s+t+a}e.user_information={userId:"",userImage:"imgs/default_userImage.png",userName:"点击设置",userSex:"点击设置",userRegion:"点击设置",userSign:"点击设置"},e.arr_userInformation={arr_userImage:"",arr_userName:"",arr_userSex:"",arr_userRegion:{region:"",city:""},arr_userSign:""},t.judge_login()&&(localStorage.hasOwnProperty("userId")&&(e.user_information.userId=localStorage.getItem("userId")),localStorage.hasOwnProperty("userImage")&&(e.user_information.userImage=localStorage.getItem("userImage")),localStorage.hasOwnProperty("userName")&&(e.user_information.userName=localStorage.getItem("userName")),localStorage.hasOwnProperty("userSex")&&(e.user_information.userSex=localStorage.getItem("userSex")),localStorage.hasOwnProperty("userRegion")&&(e.user_information.userRegion=localStorage.getItem("userRegion")),localStorage.hasOwnProperty("userSign")&&(e.user_information.userSign=localStorage.getItem("userSign"))),e.fn_set_userInformation=function(o,s,a,l,u,m,d){if(t.judge_login()){if(2==o){var _=0;"男生"==u?_=0:"女生"==u&&(_=1)}i.show_loading(),n({method:"post",url:r.update_userMessages(),data:JSON.stringify({userId:s,Image:a,userName:l,Sex:_,Region:m,Sign:d}),headers:{"Content-Type":"application/json",addToken:!0}}).success(function(t){0==t.error_code?(console.log("修改成功"),0==o?(e.user_information.userImage=a,localStorage.setItem("userImage",a)):1==o?(e.user_information.userName=l,localStorage.setItem("userName",l)):2==o?(e.user_information.userSex=u,localStorage.setItem("userSex",_)):3==o?(e.user_information.userRegion=m,localStorage.setItem("userRegion",m)):4==o&&(e.user_information.userSign=c(d,"...",5),localStorage.setItem("userSign",d))):console.log("修改失败")}).error(function(t){console.log("修改失败"),console.log("userImage:"+a),console.log("userName:"+l),console.log("userSex:"+u),console.log("userRegion:"+m),console.log("userSign:"+d),0==o?(e.user_information.userImage=a,localStorage.setItem("userImage",a)):1==o?(e.user_information.userName=l,localStorage.setItem("userName",l)):2==o?(e.user_information.userSex=u,localStorage.setItem("userSex",_)):3==o?(e.user_information.userRegion=m,localStorage.setItem("userRegion",m)):4==o&&(e.user_information.userSign=c(d,"...",5),localStorage.setItem("userSign",d))})}},a.fromTemplateUrl("html/tab_user_information_settings_setName_modal.html",{scope:e,animation:"slide-in-up"}).then(function(t){e.set_name_modal=t}),e.fn_set_name=function(){""!=e.arr_userInformation.arr_userName&&(e.fn_set_userInformation(1,e.user_information.userId,"",e.arr_userInformation.arr_userName,"","",""),e.close_set_name_modal())},e.open_set_name_modal=function(){e.set_name_modal.show()},e.close_set_name_modal=function(){e.set_name_modal.hide(),setTimeout(function(){e.arr_userInformation.arr_userName=""},1e3)},a.fromTemplateUrl("html/tab_user_information_settings_setGender_modal.html",{scope:e,animation:"slide-in-up"}).then(function(t){e.set_gender_modal=t}),e.fn_set_gender=function(){return""==e.arr_userInformation.arr_userSex?void console.log(e.arr_userInformation.arr_userSex):(e.fn_set_userInformation(2,e.user_information.userId,"","",e.arr_userInformation.arr_userSex,"",""),void e.close_set_gender_modal())},e.open_set_gender_modal=function(){e.set_gender_modal.show()},e.close_set_gender_modal=function(){e.set_gender_modal.hide(),setTimeout(function(){e.arr_userInformation.arr_userSex=""},1e3)},e.arr_china=[{province:"北京",city:["北京市"]},{province:"天津",city:["东莞市","广州市","中山市","深圳市","惠州市","江门市","珠海市","汕头市","佛山市","湛江市","河源市","肇庆市","潮州市","清远市","韶关市","揭阳市","阳江市","云浮市","茂名市","梅州市","汕尾市"]},{province:"山东",city:["济南市","青岛市","临沂市","济宁市","菏泽市","烟台市","泰安市","淄博市","潍坊市","日照市","威海市","滨州市","东营市","聊城市","德州市","莱芜市","枣庄市"]},{province:"山西",city:["太原市","大同市","运城市","长治市","晋城市","忻州市","临汾市","吕梁市","晋中市","阳泉市","朔州市"]},{province:"黑龙江",city:["齐齐哈尔市","哈尔滨市","大庆市","佳木斯市","双鸭山市","牡丹江市","鸡西市","黑河市","绥化市","鹤岗市","伊春市","大兴安岭地区","七台河市"]},{province:"吉林",city:["吉林市","长春市","白山市","白城市","延边州","松原市","辽源市","通化市","四平市"]},{province:"辽宁",city:["连市","沈阳市","丹东市","辽阳市","葫芦岛市","锦州市","朝阳市","营口市","鞍山市","抚顺市","阜新市","本溪市","盘锦市","铁岭市"]},{province:"河南",city:["郑州市","南阳市","新乡市","安阳市","洛阳市","信阳市","平顶山市","周口市","商丘市","开封市","焦作市","驻马店市","濮阳市","三门峡市","漯河市","许昌市","鹤壁市","济源市"]},{province:"河北",city:["石家庄市","唐山市","保定市","邯郸市","邢台市","河北区","沧州市","秦皇岛市","张家口市","衡水市","廊坊市","承德市"]},{province:"浙江",city:["温州市","宁波市","杭州市","台州市","嘉兴市","金华市","湖州市","绍兴市","舟山市","丽水市","衢州市"]},{province:"江苏",city:["苏州市","徐州市","盐城市","无锡市","南京市","南通市","连云港市","常州市","扬州市","镇江市","淮安市","泰州市","宿迁市"]},{province:"上海",city:["上海市"]},{province:"安徽",city:["芜湖市","合肥市","六安市","宿州市","阜阳市","安庆市","马鞍山市","蚌埠市","淮北市","淮南市","宣城市","黄山市","铜陵市","亳州市","池州市","巢湖市","滁州市"]},{province:"江西",city:["南昌市","赣州市","上饶市","吉安市","九江市","新余市","抚州市","宜春市","景德镇市","萍乡市","鹰潭市"]},{province:"湖南",city:["长沙市","邵阳市","常德市","衡阳市","株洲市","湘潭市","永州市","岳阳市","怀化市","郴州市","娄底市","益阳市","张家界市","湘西州"]},{province:"湖北",city:["武汉市","宜昌市","襄樊市","荆州市","恩施州","孝感市","黄冈市","十堰市","咸宁市","黄石市","仙桃市","随州市","天门市","荆门市","潜江市","鄂州市","神农架林区"]},{province:"新疆",city:["乌鲁木齐市","伊犁州","昌吉州","石河子市","哈密地区","阿克苏地区","巴音郭楞州","喀什地区","塔城地区","克拉玛依市","和田地区","阿勒泰州","吐鲁番地区","阿拉尔市","博尔塔拉州","五家渠市","克孜勒苏州","图木舒克市"]},{province:"云南",city:["昆明市","红河州","大理州","文山州","德宏州","曲靖市","昭通市","楚雄州","保山市","玉溪市","丽江地区","临沧地区","思茅地区","西双版纳州","怒江州","迪庆州"]},{province:"贵州",city:["贵阳市","黔东南州","黔南州","遵义市","黔西南州","毕节地区","铜仁地区","安顺市","六盘水市"]},{province:"福建",city:["漳州市","泉州市","厦门市","福州市","莆田市","宁德市","三明市","南平市","龙岩市"]},{province:"台湾",city:["台北市","高雄市","台中市","新竹市","基隆市","台南市","嘉义市"]},{province:"宁夏",city:["银川市","吴忠市","中卫市","石嘴山市","固原市"]},{province:"西藏",city:["拉萨市","山南地区","林芝地区","日喀则地区","阿里地区","昌都地区","那曲地区"]},{province:"四川",city:["成都市","绵阳市","广元市","达州市","南充市","德阳市","广安市","阿坝州","巴中市","遂宁市","内江市","凉山州","攀枝花市","乐山市","自贡市","泸州市","雅安市","宜宾市","资阳市","眉山市","甘孜州"]},{province:"重庆",city:["江北区","渝北区","沙坪坝区","九龙坡区","万州区","永川市","南岸区","酉阳县","北碚区","涪陵区","秀山县","巴南区","渝中区","石柱县","忠县","合川市","大渡口区","开县","长寿区","荣昌县","云阳县","梁平县","潼南县","江津市","彭水县","璧山县","綦江县","大足县","黔江区","巫溪县","巫山县","垫江县","丰都县","武隆县","万盛区","铜梁县","南川市","奉节县","双桥区","城口县"]},{province:"内蒙古",city:["赤峰市","包头市","通辽市","呼和浩特市","乌海市","鄂尔多斯市","呼伦贝尔市","兴安盟　 巴彦淖尔盟　 乌兰察布盟　 锡林郭勒盟　 阿拉善盟"]},{province:"广西",city:["贵港市","玉林市","北海市","南宁市","柳州市","桂林市","梧州市","钦州市","来宾市","河池市","百色市","贺州市","崇左市","防城港市"]},{province:"海南",city:["三亚市","海口市","琼海市","文昌市","东方市","昌江县","陵水县","乐东县","五指山市","保亭县","澄迈县","万宁市","儋州市","临高县","白沙县","定安县","琼中县","屯昌县"]},{province:"青海",city:["西宁市","海西州","海东地区","海北州","果洛州","玉树州","黄南藏族自治州"]},{province:"甘肃",city:["兰州市","天水市","庆阳市","武威市","酒泉市","张掖市","陇南地区","白银市","定西地区","平凉市","嘉峪关市","临夏回族自治州","金昌市","甘南州"]},{province:"陕西",city:["西安市","咸阳市","宝鸡市","汉中市","渭南市","安康市","榆林市","商洛市","延安市","铜川市"]},{province:"广东",city:["东莞市","广州市","中山市","深圳市","惠州市","江门市","珠海市","汕头市","佛山市","湛江市","河源市","肇庆市","潮州市","清远市","韶关市","揭阳市","阳江市","云浮市","茂名市","梅州市","汕尾市"]},{province:"香港",city:["香港"]},{province:"澳门",city:["澳门"]}],a.fromTemplateUrl("html/tab_user_information_settings_setRegion_modal.html",{scope:e,animation:"slide-in-up"}).then(function(t){e.set_region_modal=t}),e.$watch("$scope.arr_userInformation.arr_userRegion.region",function(t,o){t!=o&&(e.arr_userInformation.arr_userRegion.city=e.arr_userInformation.arr_userRegion.region.city)}),e.fn_set_region=function(){var t="";""!=e.arr_userInformation.arr_userRegion.region&&""!=e.arr_userInformation.arr_userRegion.city&&(t+=e.arr_userInformation.arr_userRegion.region.province+e.arr_userInformation.arr_userRegion.city,console.log(t),e.fn_set_userInformation(3,e.user_information.userId,"","","",t,""),e.close_set_region_modal())},e.open_set_region_modal=function(){e.set_region_modal.show()},e.close_set_region_modal=function(){e.set_region_modal.hide(),setTimeout(function(){e.arr_userInformation.arr_userRegion.region="",e.arr_userInformation.arr_userRegion.city=""},1e3)},a.fromTemplateUrl("html/tab_user_information_settings_setSignature_modal.html",{scope:e,animation:"slide-in-up"}).then(function(t){e.set_signature_modal=t}),e.fn_set_gender=function(){""!=e.arr_userInformation.arr_userSign&&(e.fn_set_userInformation(4,e.user_information.userId,"","","","",e.arr_userInformation.arr_userSign),e.close_set_signature_modal())},e.open_set_signature_modal=function(){e.set_signature_modal.show()},e.close_set_signature_modal=function(){e.set_signature_modal.hide(),setTimeout(function(){e.arr_userInformation.arr_userSign=""},1e3)},e.fn_logout=function(){i.show_loading();var e=localStorage.getItem("firstLoading");localStorage.clear(),localStorage.setItem("firstLoading",e),o.go("tabs.user"),s.nextDirection("back")}}]),app.controller("setHeadPictureCtrl",["$scope","$ionicActionSheet","$timeout",function(e,t,o){e.show_action_sheet=function(){t.show({buttons:[{text:"拍 照"},{text:"从相册选择"}],cssClass:"color:#53565a;",cancelText:"取 消",cancelOnStateChange:!0,cancel:function(){},buttonClicked:function(e){return!0},destructiveButtonClicked:function(e){return!0}})}}]);